<%= render partial: "consumer/error_toast" %>

<% if notice.present? && notice == "save" %>
    <div aria-live="polite" aria-atomic="true" class="position-relative rounded-3">
        <div class="toast-container p-3 top-0 end-0">
            <div class="toast bg-success" data-controller="toast">
            <div class="toast-header">
                <strong class="me-auto"><%= @toast_title %></strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body"><%= @toast_body %></div>
            </div>
        </div>
    </div>
<% end %>

<div class="container">
    <div class="text-center my-3">
        <h1 data-controller="tippy" data-tippy-content="<%= @action.description %>"><%= @action.name %></h1>
        <%= @action.documentation.gsub("\n", "<br>").html_safe %>
    </div>

    <%= render partial: "actions/force_dispatch/#{@action.name}" rescue nil %>

    <%= form_with url: action_edit_path do |form| %>
        <div id="json-editor" data-controller="json">
            <textarea id="editing" name="data" data-json-target="input" data-action="json#update scroll->json#sync_scroll keydown.enter->json#new_line" spellcheck="false"></textarea>

            <pre id="highlighting" data-json-target="scroll" aria-hidden="true"><code class="language-json" id="highlighting-content" data-json-target="highlight"><%= @formatted_json %></code></pre>
        </div>

        <div class="d-flex justify-content-center mb-5 gap-3">
            <%= link_to "Reset", action_reset_path, id: "reset-btn", class: "btn btn-danger btn-lg", data: { turbo_method: :post, turbo_confirm: "This will permanently reset changes made to this action. Are you sure?" } %>
            <%= form.submit value: "Save", class: "btn btn-success btn-lg" %>
        </div>
    <% end %>

</div>